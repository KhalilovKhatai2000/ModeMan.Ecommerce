@model RegisterViewModel

@{
    ViewData["Title"] = "Qeydiyyat";
}

<div class="form-card card shadow-sm">
    <div class="card-body p-4">
        <h2 class="card-title mb-3">Hesab yaradın</h2>
        <p class="text-muted small mb-4">Xoş gəlmisiniz! Aşağıdakı məlumatlarla qeydiyyat tamamlayın.</p>

        <form asp-action="Register" method="post" novalidate>
            @Html.AntiForgeryToken()

            <div class="mb-3">
                <label asp-for="UserName" class="form-label">Ad</label>
                <input asp-for="UserName" class="form-control" placeholder="Ad" />
                <div class="form-text">Adınızı yazın.</div>
                <span asp-validation-for="UserName" class="text-danger small"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Surname" class="form-label">Soyad</label>
                <input asp-for="Surname" class="form-control" placeholder="Soyad" />
                <div class="form-text">Soyadınızı yazın.</div>
                <span asp-validation-for="Surname" class="text-danger small"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Email" class="form-label">Email ünvanı</label>
                <input asp-for="Email" class="form-control" placeholder="name@example.com" />
                <span asp-validation-for="Email" class="text-danger small"></span>
            </div>

            <div class="mb-3 position-relative">
                <label asp-for="Password" class="form-label">Şifrə</label>

                <div class="input-group">
                    <input asp-for="Password" class="form-control" id="passwordInput" placeholder="Güclü bir şifrə daxil edin" autocomplete="new-password" />
                    <button type="button" class="btn btn-outline-secondary password-toggle" id="togglePassword" aria-label="Show or hide password">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                            <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8z" />
                            <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z" />
                        </svg>
                    </button>
                </div>

                <div class="form-text">Minimum 6 simvol. Böyük hərf, rəqəm əlavə etməyi tövsiyə edirik.</div>
                <span asp-validation-for="Password" class="text-danger small"></span>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                    <span id="btnText">Qeydiyyat</span>
                    <span id="btnSpinner" class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
                </button>
            </div>

            <div class="mt-3 text-center small">
                Hesabınız var? <a href="@Url.Action("Login", "Account")">Giriş</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
            // Password show/hide
            const pwdInput = document.getElementById('passwordInput');
            const toggleBtn = document.getElementById('togglePassword');
            toggleBtn.addEventListener('click', function () {
                const type = pwdInput.getAttribute('type') === 'password' ? 'text' : 'password';
                pwdInput.setAttribute('type', type);

                // Toggle icon (simple)
                this.querySelector('svg').classList.toggle('bi-eye');
                this.querySelector('svg').classList.toggle('bi-eye-slash');
            });

            // Simple submit loading state
            const form = document.querySelector('form[asp-action="Register"]') || document.querySelector('form');
            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const btnSpinner = document.getElementById('btnSpinner');

            form.addEventListener('submit', function (e) {
                if ($(this).valid && !$(this).valid()) {
                    // let jQuery validation show errors
                    return;
                }
                // disable button & show spinner
                submitBtn.setAttribute('disabled', 'disabled');
                btnSpinner.classList.remove('d-none');
                btnText.textContent = 'Gözləyin...';
            });
        })();
    </script>
}
